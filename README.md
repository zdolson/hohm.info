# hohm.info

Home listings with deep tag knowledge. Next.js 15 + Payload 3 + Postgres (Supabase).

## Setup

1. Copy `.env.example` to `.env.local` and set `DATABASE_URL`, `PAYLOAD_SECRET`, `NEXT_PUBLIC_SERVER_URL`.
2. `pnpm install`.
3. `pnpm dev` — app at http://localhost:3000, admin at http://localhost:3000/admin.

## Scripts

| Script | Purpose |
|--------|---------|
| `pnpm dev` | Start dev server |
| `pnpm build` | Production build |
| `pnpm start` | Start production server |
| `pnpm lint` | ESLint |
| `pnpm format` | Prettier format |
| `pnpm test` | Vitest unit/integration |
| `pnpm test:e2e` | Playwright E2E (run `npx playwright install` once) |
| `pnpm generate:types` | Regenerate `src/payload-types.ts` from Payload config |
| `pnpm migrate:create` | Create a new migration (production workflow) |
| `pnpm migrate` | Run pending migrations (production) |

## Migrations

- **Development:** Use Payload **push** mode — schema syncs from config on dev server start. Add/remove fields in collections, restart dev; no migration file needed.
- **Production:** Use **migrate**. When schema is stable: `pnpm migrate:create` to generate a migration, commit it, then `pnpm migrate` in prod. Do not mix push (dev) and migrate (prod) on the same branch; keep migrations in version control.

## Types

`src/payload-types.ts` is generated by `payload generate:types` (also runs postinstall if DB is available). To regenerate: `pnpm generate:types`.
